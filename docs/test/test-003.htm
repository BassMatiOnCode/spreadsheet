<!DOCTYPE html>
<html lang="en-US"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="template-info" file-name="empty.htm" version="2022-12-01" editor="USP" />
<meta name="author" content="USP" />
<meta name="creation-date" content="2023-01-20" />
<meta name="editor" content="USP" />
<meta name="change-date" content="2023-01-20" />
<meta name="version" content="1" />
<meta name="categories" content="Projects > JavaScript" />
<meta name="tags" content="project, JavaScript, HTML, spreadsheet, library, require" />
<meta name="description" content="Initial test." />

<link rel="icon" type="image/png" href="/favicon.png" sizes="16x16" />
<link rel="stylesheet" href="/inc/page.css" />
<link rel="stylesheet" href="/site.css" />
<link rel="stylesheet" href="spreadsheet-0.css" />

<style>
table.flat-borders td { text-align : left ; vertical-align : top }
p { tab-size : 4 ; white-space:pre-wrap }
</style>
 
<title>Projects - SpreadSheet.JS - Test 3</title>

</head><body><header id="page-header"><object data="title.svg" type="image/svg+xml"></object></header><div id="main-toolbar"></div><main id="page-content">

<h1>Test 3 Generate Row and Column Labels</h1>
	
<p>Row and column labels can (and should be) generated by the library, and not be created manually, which cound easily introduce errors. </p>

<p>The <tt>gen-labels</tt> attribute controls where the labels are created, at the top, left, bottom or right side.</p>

<p>There is a certain order to be followed:</p>

<ol>
<li>Create logical row and column numbers attributes</li>
<li>Create column labels</li>
<li>Create row labels</li>
</ol>

<p>TODO: With this order in place, the existing code could be simplified, certain special cases will not occur.</p>

<p>TODO: Test more cominations,</p>

<table id="sheet-1" class="flat-borders"><tbody><tr>
	<td xpr="123">0,0</td>
	<td>0,1</td>
	<td>0,2</td>
	<td>0,3</td>
</tr><tr>
	<td>1,0</td>
	<td rowspan="2" colspan="2">1,1</td>
	<td>1,3</td>
</tr><tr>
	<td>2,0</td>
	<td>2,3</td>
</tr><tr>
	<td>3,0</td>
	<td>3,1</td>
	<td>3,2</td>
	<td>3,3</td>
</tr></tbody></table>

<p id="result-1">Test by visual inspection 
	Success</p>
	
</main><footer id="page-footer"></footer>
	
<script type="module" src="/inc/page.js" ></script>

<script type="module">
let errors = 0;
import * as spreadsheet from './spreadsheet-0.js';
spreadsheet.state.currentSpreadsheet = document.getElementById("sheet-1");
// Engage spreadsheet stylesheet
spreadsheet.state.currentSpreadsheet.classList.add("spreadsheet");
	
spreadsheet.initLogicalCellAddresses( spreadsheet.state.currentSpreadsheet );
/*
spreadsheet.insertColumnLabels( spreadsheet.state.currentSpreadsheet );
spreadsheet.appendColumnLabels( spreadsheet.state.currentSpreadsheet );
spreadsheet.insertRowLabels( spreadsheet.state.currentSpreadsheet );
spreadsheet.appendRowLabels( spreadsheet.state.currentSpreadsheet );
*/

// spreadsheet.state.currentSpreadsheet.setAttribute("gen-labels", "all");
spreadsheet.state.currentSpreadsheet.setAttribute("gen-labels", "both");
spreadsheet.createLabels( spreadsheet.state.currentSpreadsheet );

// Summary
document.getElementById( "result-1" ).innerHTML += `<br/>${errors} errors` ;
</script>

</body></html>