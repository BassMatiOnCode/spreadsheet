<!DOCTYPE html>
<html lang="en-US"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="template-info" file-name="empty.htm" version="2022-12-01" editor="USP" />
<meta name="author" content="USP" />
<meta name="creation-date" content="2023-01-20" />
<meta name="editor" content="USP" />
<meta name="change-date" content="2023-01-20" />
<meta name="version" content="1" />
<meta name="categories" content="Projects > JavaScript" />
<meta name="tags" content="project, JavaScript, HTML, spreadsheet, library, require" />
<meta name="description" content="Initial test." />

<link rel="icon" type="image/png" href="/favicon.png" sizes="16x16" />
<link rel="stylesheet" href="/inc/page.css" />
<link rel="stylesheet" href="/site.css" />
<link rel="stylesheet" href="/inc/spreadsheet-0.css" />

<style>
table.flat-borders td { text-align : left ; vertical-align : top }
</style>
 
<title>Projects - SpreadSheet.JS - Test 7</title>

</head><body><header id="page-header"><object data="/title.svg" type="image/svg+xml"></object></header><div id="main-toolbar"></div><main id="page-content">

<h1>Test 8 &emsp; Load from Disk</h1>

<p>Status: pending.</p>

<p>Instructions: Click "Choose File". This opens a file-open dialog. Select the desired file and click "OK". The filename should appear next to the file selector button. Click "Load".</p>

<p>Verify that the content of the spreadsheet changed.</p>
<p>Compare the content of the textfile with the spreadsheet table below. Cell values should be identical.</p>
<p>Compare the HTML code of the spreadsheet table below in the browser developer tools with the text file content. They should be identical.</p>

<button id="button-1">Load</button> <input id="selector-1" type="file" accept="text/plain" />



<table id="sheet-1" class="spreadsheet flat-borders">
<tr>
	<td>A</td>
	<td contenteditable>0</td>
</tr><tr>
	<td>B</td>
	<td contenteditable>1</td>
</tr><tr>
	<td>C</td>
	<td contenteditable></td>
</tr><tr>
	<td>D</td>
	<td data-xpr="cell(1,1)*3"></td>
</tr>
</table>

<p><a id="link-1" href="">Download</a></p>

<dialog id="dialog-1"><form method="dialog">
	<p id="msg">Message</p>
	<button name="ok">OK</button> <button name ="cancel">Cancel</button>
	</form></dialog>

<button id="dbutton">Dialog</button>

</main><footer id="page-footer"></footer>
<script type="module" src="/inc/page.js" ></script>

<script type="module">
import * as spreadsheetCore from "./spreadsheet-core-0.js" ;
spreadsheetCore.initPage( );
import * as spreadsheetPersistence from "./spreadsheet-persistence-0.js" ;
spreadsheetPersistence.setupSaveLink( "link-1", "sheet-1", "sheet-1.txt", "text/plain" );
spreadsheetPersistence.setupLoadCommand ( "button-1", "selector-1", "sheet-1" );

import { norm, normElements } from "./spreadsheet-utility-0.js" ;
let a = "button-1", b = "selector-1", c = "link-1";
[ a, b, c ] = normElements( [ "button-1", "selector-1", "link-1" ] );
console.log ( a, b, c );

	/*
let result = document.getElementById( "dbutton" ).addEventListener( "click", e => {
	const result = document.getElementById( "dialog-1" ).showModal( ) ;
	debugger;
	} );
	*/
	
let result = document.getElementById( "dbutton" ).addEventListener( "click", e => {
	console.log( confirm("test"));
	} ) ;

</script>

</body></html>