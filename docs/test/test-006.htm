<!DOCTYPE html>
<html lang="en-US"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="template-info" file-name="empty.htm" version="2022-12-01" editor="USP" />
<meta name="author" content="USP" />
<meta name="creation-date" content="2023-01-20" />
<meta name="editor" content="USP" />
<meta name="change-date" content="2023-01-20" />
<meta name="version" content="1" />
<meta name="categories" content="Projects > JavaScript" />
<meta name="tags" content="project, JavaScript, HTML, spreadsheet, library, require" />
<meta name="description" content="Initial test." />

<link rel="icon" type="image/png" href="/favicon.png" sizes="16x16" />
<link rel="stylesheet" href="/inc/page.css" />
<link rel="stylesheet" href="/site.css" />
<link rel="stylesheet" href="/inc/spreadsheet.css" />
<link rel="stylesheet" href="./test.css" />

<style>
table.flat-borders td { text-align : left ; vertical-align : top }
</style>
 
<title>Projects - SpreadSheet.JS - Test 6</title>

</head><body><header id="page-header"><object data="/title.svg" type="image/svg+xml"></object></header><div id="main-toolbar"></div><main id="page-content">

<h1>Test <span id="test-number">6</span> - <span id="test-title">User-Defined Functions</span></h1>

<p>Status: <span id="status">pending</span>.
<br/>Result: <span id="result" value="undefined"></span>
<br/><span id="tests">0</span> tests <span id="errors">0</span> errors</p>

<p>Extending spreadsheet-core.js</p>

<p>The module <tt>spreadsheet-functions.js</tt> extends <tt>spreadsheet-core.js</tt> with additional functions for use in formulas. This module is loaded statically.</p>

<p>Other modules with more specific functions can be loaded dynamically from the HTML document.</p>

<p>Both functions are tested here. If everything went well, the strings "Hello, world!" and "In time we hate that which we often fear." will appear in rows 2 and 3.</p>

<table id="sheet-1" class="spreadsheet"  labels="generate,all">
<tr>
	<td>A</td>
	<td>0</td>
</tr><tr>
	<td>B</td>
	<td>1</td>
</tr><tr>
	<td>C</td>
	<td data-xpr="test()"></td>
</tr><tr>
	<td>D</td>
	<td data-xpr="test2()"></td>
</tr>
</table>

</main><footer id="page-footer"></footer>
<script type="module" src="/inc/page.js" ></script>
<xscript type="module" src="spreadsheet-core.js" ></xscript>
<script type="module">
import { check, report, logError, publishResults } from "./test.js" ;
import * as spreadsheetCore from './spreadsheet-core.js';
spreadsheetCore.importModule( "./spreadsheet-udf.js" )
.then ( spreadsheetCore.initPage )
.then ( ( ) => {
	const table = document.getElementById( "sheet-1" );
	check( "6.1", table.rows[ 3 ].cells[ 2 ].innerText, "Hello, world!", "Unexpected cell text" );
	check( "6.2", table.rows[ 4 ].cells[ 2 ].innerText, "In time we hate that which we often fear.", "Unexpected cell text" );
	publishResults( );
	} ) ;
</script>

</body></html>