<!DOCTYPE html>
<html lang="en-US"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="template-info" file-name="empty.htm" version="2022-12-01" editor="USP" />
<meta name="author" content="USP" />
<meta name="creation-date" content="2023-01-20" />
<meta name="editor" content="USP" />
<meta name="change-date" content="2023-01-20" />
<meta name="version" content="1" />
<meta name="categories" content="Projects > JavaScript" />
<meta name="tags" content="project, JavaScript, HTML, spreadsheet, library, require" />
<meta name="description" content="Insert rows test document." />

<link rel="icon" type="image/png" href="/favicon.png" sizes="16x16" />
<link rel="stylesheet" href="/inc/page.css" />
<link rel="stylesheet" href="/site.css" />
<link rel="stylesheet" href="spreadsheet.css" />
<link rel="stylesheet" href="test.css" />

<style>
table.flat-borders td { text-align : left ; vertical-align : top }
</style>
 
<title>Projects - Spreadsheet - Test 9 - Insert Rows</title>

</head><body>

<h1>Test <span id="test-number">9</span> - <span id="test-title">Insert Rows</h1>

<p>Status: <span id="status">pending</span>.
<br/>Result: <span id="result" value="undefined"></span>
<br/><span id="tests">0</span> tests <span id="errors">0</span> errors</p>

<table id="sheet-1" class="spreadsheet" labels="generate,all">
<tr>
	<td>A</td>
	<td data-xpr="cell(2,1)"></td>
</tr><tr>
	<td>B</td>
	<td>1</td>
</tr><tr>
	<td>C</td>
	<td>2</td>
</tr><tr>
	<td>D</td>
	<td data-xpr="cell(1,1)*3"></td>
</tr>
</table>

<script type="module">
import * as spreadsheetCore from "./spreadsheet-core.js" ;
import { report, check, publishResults } from "./test.js" ;
import { insertRows } from "./spreadsheet-structure.js" ;
document.getElementById( "status" ).innerText = "started" ;
spreadsheetCore.initPage( );
spreadsheetCore.setCurrentSheet( "sheet-1" );
// debugger;
check( "9.1", "cell(2,1)", spreadsheetCore.cellObject(0,1).dataset.xpr, "Value expression mismatch" );
check( "9.2", "cell(1,1)*3", spreadsheetCore.cellObject(3,1).dataset.xpr, "Value expression mismatch" );
insertRows( 3, 3, "TD" );
check( "9.3", "cell(5,1)", spreadsheetCore.cellObject(0,1).dataset.xpr, "Value expression mismatch" );
check( "9.4", "cell(1,1)*3", spreadsheetCore.cellObject(6,1).dataset.xpr, "Value expression mismatch" );

// TODO : More tests.

publishResults( );
</script>

</body></html>