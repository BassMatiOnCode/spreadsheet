<!DOCTYPE html>
<html lang="en-US"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="template-info" file-name="empty.htm" version="2022-12-01" editor="USP" />
<meta name="author" content="USP" />
<meta name="creation-date" content="2023-01-20" />
<meta name="editor" content="USP" />
<meta name="change-date" content="2023-01-20" />
<meta name="version" content="1" />
<meta name="categories" content="Projects > JavaScript" />
<meta name="tags" content="project, JavaScript, HTML, spreadsheet, library, require" />
<meta name="description" content="Initial test." />

<link rel="icon" type="image/png" href="/favicon.png" sizes="16x16" />
<link rel="stylesheet" href="/inc/page.css" />
<link rel="stylesheet" href="/site.css" />
<link rel="stylesheet" href="spreadsheet.css" />
<link rel="stylesheet" href="test.css" />
 
<title>Projects - Spreadsheet - Test 5</title>

</head><body>

<h1>Test <span id="test-number">5</span> - <span id="test-title">setCellValue()</span></h1>

<p>Status: <span id="status">pending</span>.
<br/>Result: <span id="result" value="undefined"></span>
<br/><span id="tests">0</span> tests <span id="errors">0</span> errors</p>

<p>The function setCellValue() is used to read the cell.innerText, convert it into a typed JavaScriptObject and store it in cell.spreadsheetCore.value. This test verifies that the type is correctly guessed from the input string.</p>

<p>setCellValue() is used in two situations:</p>

<ol>
<li>When the spreadsheet table is initialized</li>
<li>When the user finished cell editing.</li>
</ol>

<p>The following test verifies that the expected data type is equal to the computed (guessed) type.</p>

<table id="sheet-1" class="spreadsheet" labels="generate,both"><tbody><tr>
	<th>Expected</th>
	<th>Input</th>
	<th>Formatted</th>
	<th>Computed</th>
</tr><tr>
	<td>string</td>
	<td>s$ABC</td>
	<td>ABC</td>
	<td xpr="typeof cell(rr(0),rc(-1)).spreadsheetCore.value"></td>
</tr><tr>
	<td>number</td>
	<td>s$123</td>
	<td>123</td>
	<td xpr="typeof cell(rr(0),rc(-1)).spreadsheetCore.value"></td>
</tr><tr>
	<td>string</td>
	<td>s$2023-01-25</td>
	<td>2023-01-25</td>
	<td xpr="typeof cell(rr(0),rc(-1)).spreadsheetCore.value"></td>
</tr><tr>
	<td>boolean</td>
	<td>s$true</td>
	<td>true</td>
	<td xpr="typeof cell(rr(0),rc(-1)).spreadsheetCore.value"></td>
</tr><tr>
	<td>boolean</td>
	<td>s$false</td>
	<td>false</td>
	<td xpr="typeof cell(rr(0),rc(-1)).spreadsheetCore.value"></td>
</tr><tr>
	<th colspan="4">With type prefix hint</th>
</tr><tr>
	<td>string</td>
	<td>s$s$ABC</td>
	<td>s$ABC</td>
	<td xpr="typeof cell(rr(0),rc(-1)).spreadsheetCore.value"></td>
</tr><tr>
	<td>number</td>
	<td>s$n$123</td>
	<td>n$123</td>
	<td xpr="typeof cell(rr(0),rc(-1)).spreadsheetCore.value"></td>
</tr><tr>
	<td>date</td>
	<td>s$d$2023-01-25</td>
	<td>d$2023-01-25</td>
	<td xpr="typeof cell(rr(0),rc(-1)).spreadsheetCore.value"></td>
</tr><tr>
	<td>boolean</td>
	<td>s$b$true</td>
	<td>b$true</td>
	<td xpr="typeof cell(rr(0),rc(-1)).spreadsheetCore.value"></td>
</tr><tr>
	<td>boolean</td>
	<td>s$b$false</td>
	<td>b$false</td>
	<td xpr="typeof cell(rr(0),rc(-1)).spreadsheetCore.value"></td>
</tr><tr>
	<td contenteditable colspan="2">Input</td>
</tr></tbody></table>

<script type="module">
document.getElementById( "status" ).innerText = "started" ;
import { report, check, publishResults } from "./test.js" ;

import * as spreadsheet from './spreadsheet-core.js';
spreadsheet.initPage();
let sheet = document.getElementById("sheet-1");
spreadsheet.setCurrentSheet( sheet );

check( "5.1", "ABC", spreadsheet.cellObject(1,2).spreadsheetCore.value, "Value mismatch" );
check( "5.2", 123, spreadsheet.cellObject(2,2).spreadsheetCore.value, "Value mismatch" );
check( "5.3", "2023-01-25", spreadsheet.cellObject(3,2).spreadsheetCore.value, "Value mismatch" );
check( "5.4", true, spreadsheet.cellObject(4,2).spreadsheetCore.value, "Value mismatch" );
check( "5.5", false, spreadsheet.cellObject(5,2).spreadsheetCore.value, "Value mismatch" );
check( "5.6", "ABC", spreadsheet.cellObject(7,2).spreadsheetCore.value, "Value mismatch" );
check( "5.7", 123, spreadsheet.cellObject(8,2).spreadsheetCore.value, "Value mismatch" );
check( "5.8", new Date("2023-01-25").toString(), spreadsheet.cellObject(9,2).spreadsheetCore.value.toString(), "Value mismatch" );
check( "5.4", true, spreadsheet.cellObject(10,2).spreadsheetCore.value, "Value mismatch" );
check( "5.5", false, spreadsheet.cellObject(11,2).spreadsheetCore.value, "Value mismatch" );

publishResults();
</script>

</body></html>